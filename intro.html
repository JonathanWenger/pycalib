

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Non-Parametric Calibration for Classification &mdash; pycalib  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Documentation" href="modules.html" />
    <link rel="prev" title="Welcome to pycalib’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> pycalib
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Non-Parametric Calibration for Classification</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installation-and-documentation">Installation and Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#experiments-and-benchmark-datasets">Experiments and Benchmark Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="#publication">Publication</a></li>
<li class="toctree-l2"><a class="reference internal" href="#license-and-contact">License and Contact</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pycalib</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Non-Parametric Calibration for Classification</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/intro.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="non-parametric-calibration-for-classification">
<span id="intro"></span><h1>Non-Parametric Calibration for Classification<a class="headerlink" href="#non-parametric-calibration-for-classification" title="Permalink to this headline">¶</a></h1>
<a class="reference external image-reference" href="https://travis-ci.org/JonathanWenger/pycalib"><img alt="Build Status" src="https://travis-ci.org/JonathanWenger/pycalib.svg?branch=master" /></a>
<p>This repository provides an implementation of the paper <a class="reference external" href="https://arxiv.org/abs/1906.04933">“Non-Parametric Calibration for Classification”</a> (Jonathan Wenger, Hedvig Kjellström, Rudolph Triebel) published at AISTATS 2020. All results presented in our work were produced with this code.</p>
<p align="center">
  <img src="https://raw.githubusercontent.com/JonathanWenger/pycalib/master/figures/ece_logloss_example/ece_logloss.png" alt="latent_process" width="700"/>
</p><div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Many applications of classification methods not only require high accuracy but also reliable estimation of predictive uncertainty. However, while many current classification frameworks, in particular deep neural networks, achieve high accuracy, they tend to incorrectly estimate uncertainty. We provide a method that adjusts the confidence estimates of a general classifier such that they approach the probability of classifying correctly. In contrast to existing approaches, our calibration method employs a non-parametric representation using a latent Gaussian process, and is specifically designed for multi-class classification. It can be applied to any classifier that outputs confidence estimates and is not limited to neural networks. In the experiments included in this repository, we show the universally strong performance of our method across different classifiers and benchmark data sets, in particular for state-of-the art neural network architectures.</p>
<p align="center">
  <img src="https://raw.githubusercontent.com/JonathanWenger/pycalib/master/figures/gpcalib_illustration/diagram_calibration.png" alt="diagram_calibration" width="400"/>
  <img src="https://raw.githubusercontent.com/JonathanWenger/pycalib/master/figures/gpcalib_illustration/latent_process.png" alt="latent_process" width="400"/>
</p></div>
<div class="section" id="installation-and-documentation">
<h2>Installation and Documentation<a class="headerlink" href="#installation-and-documentation" title="Permalink to this headline">¶</a></h2>
<p>The code was developed in Python 3.6 under Ubuntu (18.04). You can install this Python 3 package using <code class="docutils literal notranslate"><span class="pre">pip</span></code> (or <code class="docutils literal notranslate"><span class="pre">pip3</span></code>):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install setuptools numpy scipy scikit-learn cython
pip install git+https://github.com/JonathanWenger/pycalib.git
</pre></div>
</div>
<p>Note that some dependencies need to be installed separately since a subset of experiments rely on
<a class="reference external" href="https://github.com/scikit-garden/scikit-garden">scikit-garden</a>. You can also clone this repository to run the scripts</p>
<blockquote>
<div><p>reproducing the experiments in the paper via</p>
</div></blockquote>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install setuptools numpy scipy scikit-learn cython
git clone https://github.com/JonathanWenger/pycalib
<span class="nb">cd</span> pycalib
python setup.py install
</pre></div>
</div>
<p>For tips on getting started and how to use this package please refer to the <a class="reference external" href="https://jonathanwenger.github.io/pycalib/">documentation</a>.</p>
</div>
<div class="section" id="experiments-and-benchmark-datasets">
<h2>Experiments and Benchmark Datasets<a class="headerlink" href="#experiments-and-benchmark-datasets" title="Permalink to this headline">¶</a></h2>
<p>We performed calibration experiments for binary and multi-class benchmark datasets from computer vision for a range of classifiers and calibration methods. We found that GP calibration performed particularly well on large-scale architectures and challenging data sets.</p>
<p align="center">
  <img src="https://raw.githubusercontent.com/JonathanWenger/pycalib/master/figures/gpcalib_illustration/calibration_experiment_results.png" alt="latent_process" width="700"/>
</p><p>The experiments can be reproduced by using the scripts in <code class="docutils literal notranslate"><span class="pre">benchmark</span></code> and <code class="docutils literal notranslate"><span class="pre">figures</span></code>. The datasets we used and how to obtain them are listed below.</p>
<ul class="simple">
<li><p><strong>PCam</strong>: Due to the size of the data, only a script replicating the experiments is provided. The data can be downloaded from the
<a class="reference external" href="https://github.com/basveeling/pcam">PCam repository</a>.</p></li>
<li><p><strong>KITTI</strong>: The repository includes 64-dimensional features extracted from KITTI sequences compressed in a zip file
<code class="docutils literal notranslate"><span class="pre">datasets/kitti/kitti_data.zip</span></code>.</p></li>
<li><p><strong>MNIST</strong>: A script will automatically download the MNIST dataset if needed.</p></li>
<li><p><strong>CIFAR-100</strong>: When the CIFAR-100 experiment is run, there is an option to automatically download the dataset.</p></li>
<li><p><strong>ImageNet 2012</strong>: Due to the size of the data, only a script replicating the experiments is provided. The ImageNet validation data can be
obtained from the <a class="reference external" href="http://www.image-net.org">ImageNet website</a>.</p></li>
</ul>
</div>
<div class="section" id="publication">
<h2>Publication<a class="headerlink" href="#publication" title="Permalink to this headline">¶</a></h2>
<p>If you use this repository in your research, please cite the following paper:</p>
<ol class="upperalpha simple" start="10">
<li><p>Wenger, H. Kjellström, and R. Triebel. Non-parametric calibration for classification (<a class="reference external" href="https://arxiv.org/pdf/1906.04933.pdf">PDF</a>). In <em>Proceedings of the 23rd International Conference on Artificial Intelligence and Statistics (AISTATS)</em>.</p></li>
</ol>
<div class="highlight-bibtex notranslate"><div class="highlight"><pre><span></span><span class="nc">@InProceedings</span><span class="p">{</span><span class="nl">wenger2020calibration</span><span class="p">,</span>
  <span class="na">title</span>         <span class="p">=</span> <span class="s">{Non-Parametric Calibration for Classification}</span><span class="p">,</span>
  <span class="na">author</span>        <span class="p">=</span> <span class="s">{Jonathan Wenger and Hedvig Kjellstr{\&quot;o}m and Rudolph Triebel}</span><span class="p">,</span>
  <span class="na">booktitle</span>     <span class="p">=</span> <span class="s">{Proceedings of the 23rd International Conference on Artificial Intelligence and Statistics (AISTATS)}</span><span class="p">,</span>
  <span class="na">year</span>          <span class="p">=</span> <span class="s">{2020}</span><span class="p">,</span>
  <span class="na">series</span>        <span class="p">=</span> <span class="s">{Proceedings of Machine Learning Research}</span><span class="p">,</span>
  <span class="na">keywords</span>      <span class="p">=</span> <span class="s">{calibration, non-parametric, gaussian processes, classification}</span><span class="p">,</span>
  <span class="na">url</span>           <span class="p">=</span> <span class="s">{https://github.com/JonathanWenger/pycalib}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="license-and-contact">
<h2>License and Contact<a class="headerlink" href="#license-and-contact" title="Permalink to this headline">¶</a></h2>
<p>This work is released under the <a class="reference external" href="https://github.com/JonathanWenger/pycalib/blob/master/LICENSE">MIT License</a>.</p>
<p>Please submit an <a class="reference external" href="https://github.com/JonathanWenger/pycalib/issues/new">issue on GitHub</a> to report bugs or request changes.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="modules.html" class="btn btn-neutral float-right" title="Documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to pycalib’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Jonathan Wenger

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>